## ✔ PCB (Process Control Block)
: 운영체제에서 프로세스에 대한 메타데이터를 저장한 `데이터`
- 프로세스 제어 블록이라고도 한다.
- 프로세스가 생성되면 운영체제는 해당 PCB를 생성한다.

(1) 프로그램이 실행되면 `프로세스가 생성`되고  
(2) 프로세스 주소 값들에 스택, 힙 등의 구조를 기반으로 `메모리가 할당`된다.  
(3) 그리고 이 프로세스의 메타데이터들이 `PCB에 저장되어 관리`된다.  
    이는 프로세스의 중요한 정보를 포함하고 있기 때문에 일반 사용자가 접근하지 못하도록 __커널 스택의 `가장 앞부분`에서 관리된다.__

```
(1) 메타데이터
  - 데이터에 관한 구조화된 데이터이자 데이터를 설명하는 작은 데이터
  - 대량의 정보 가운데에서 찾고 있는 정보를 효율적으로 찾아내서 이용하기 위해 일정한 규칙에 따라 콘텐츠에 대해 부여되는 데이터
```

- - -
### 1. PCB의 구조
- __프로세스 스케줄링 상태__
  - '준비', '일시중단' 프로세스가 CPU에 대한 소유권을 얻은 이후 또는 이후 경과된 시간과 같은 기타 스케줄링 정보
- __프로세스 ID__
  - 프로세스 ID, 해당 프로세스의 자식 프로세스 ID
- __프로세스 권한__
  - 컴퓨터 자원 또는 I/O 디바이스에 대한 권한 정보
- __프로그램 카운터__
  - 프로세스에서 실행해야 할 다음 명령어의 주소에 대한 포인터
- __CPU 레지스터__
  - 프로세스를 실행하기 위해 저장해야 할 레지스터에 대한 정보
- __계정 정보__
  - 프로세스 실행에 사용된 CPU 사용량, 실행한 유저의 정보
- __I/O 상태 정보__
  - 프로세스에 할당된 I/O 디바이스 목록

- - -
### 2. 컨텐스트 스위칭 (context switching)
: PCB를 교환하는 과정
- 한 프로세스에 할당된 시간이 끝나거나 인터럽트에 의해 발생한다.
- 컴퓨터는 많은 프로그램을 동시에 실행하는 것처럼 보이지만 어떠한 시점에서 실행되고 있는 프로세스는 단 한개이다.
  - [싱글코어 기준] 많은 프로세스가 동시에 구동되는 것처럼 보이는 것은 다른 프로세스와의 `컨텍스트 스위칭`이 아주 빠른 속도로 실행되기 때문이다.
  - 현대 컴퓨터는 `멀티코어`의 CPU를 가지기 때문에 한 시점에 한 개의 프로그램이라는 설명은 틀린 설명이다.

![컨텍스트 스위칭](https://user-images.githubusercontent.com/54324782/193983276-fd1e00f7-9975-4728-9bac-e1cc763e72a8.png)

```
(1) 한 개의 프로세스 P0가 실행하다 멈추고, 프로세스 P0의 PCB를 저장
(2) 프로세스 P1을 로드하여 실행
(3) 다시 프로세스 P1의 PCB를 저장
(4) 프로세스 P0의 PCB를 로드

* idle: 유휴 시간 (컴퓨터 시스템이 사용 가능한 상태이나 실제적인 작업이 없는 시간)
```
- 이뿐만 아니라 컨텍스트 스위칭에 드는 비용이 더 있다.

### 💡 비용: 캐시미스
- 컨텍스트 스위칭이 일어날 때 프로세스가 가지고 있는 메모리 주소가 그대로 있으면 잘못된 주소 변환이 생긴다.
  - 그러므로, `캐시클리어 과정`을 겪게 되고 이 때문에 `캐시미스`가 발생한다.

### 💡 스레드에서의 컨텍스트 스위칭
- 컨텍스트 스위칭은 `스레드`에서도 일어난다.
- 스레드는 스택 영역을 제외한 모든 메모리를 공유하기 때문에 `스레드 컨텍스트 스위칭`의 경우 비용이 더 적고 시간도 더 적게 걸린다.
