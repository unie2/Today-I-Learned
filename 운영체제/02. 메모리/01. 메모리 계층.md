#### 사전 지식
- `CPU`는 그저 `메모리`에 올라와 있는 프로그램의 명령어들을 실행할 뿐이다.

- - -
## ✔ 메모리 계층
- 메모리 계층은 `레지스터`, `캐시`, `메모리`, `저장장치`로 구성되어 있다.

![메모리 계층](https://user-images.githubusercontent.com/54324782/190950320-174e61e9-0d8e-4c4e-9c33-0092d0d48dea.png)

```
(1) 레지스터: CPU 안에 있는 작은 메모리
  - 휘발성
  - 속도 가장 빠르다.
  - 기억 용량이 가장 적다.
(2) 캐시: L1, L2 캐시를 지칭
  - 휘발성
  - 속도 빠르다.
  - 기억 용량이 적다.
  - L3 캐시도 있다.
(3) 주기억장치: RAM을 가리킴
  - 휘발성
  - 속도 보통
  - 기억 용량이 보통
(4) 보조기억장치: HDD, SSD를 가리킴
  - 휘발성
  - 속도 낮음
  - 기억 용량이 많다.
```

- 램(RAM)은 하드디스크(HDD)로부터 일정량의 데이터를 복사해서 임시 저장하고 이를 필요 시마다 CPU에 빠르게 전달하는 역할을 한다.
- 계층 위로 올라갈수록 가격은 비싸지는데 용량은 작아지고 속도는 빨라지는 특징이 있다.
  - 계층이 있는 이유: `경제성`과 `캐시`
    - ex. 16GB RAM은 8만원에 구매하지만, 16GB SSD는 훨씬 더 싼 가격에 구매 가능

- - -
### 1. 캐시(Cache)
: 데이터를 미리 복사해 놓는 임시 저장소이자 빠른 장치와 느린 장치에서 `속도 차이에 따른 병목 현상`을 줄이기 위한 메모리
- 이를 통해 데이터를 접근하는 시간이 오래 걸리는 경우를 해결
- 무언가를 다시 계산하는 시간을 절약할 수 있다.
- 실제로 메모리와 CPU 사이의 속도 차이가 너무 크기 때문에 그 중간에 `레지스터 계층`을 둬서 속도 차이를 해결
  - 캐싱 계층: 속도 차이를 해결하기 위해 계층과 계층 사이에 있는 계층
    - ex. 캐시 메모리와 보조기억장치 사이에 있는 `주기억장치`를 보조기억장치의 `캐싱 계층`이라고 할 수 있다.

#### 💡 지역성의 원리
- 캐시 계층을 두는 것 말고 캐시를 직접 설정할 때 자주 사용하는 데이터에 대한 근거는 `지역성`이다.
  - 시간 지역성(Temporal Locality)
  - 공간 지역성(Spatial Locality)

#### "시간 지역성(Temporal Locality)"
: 최근 사용한 데이터에 다시 접근하려는 특성
#### "공간 지역성(Spatial Locality)"
: 최근 접근한 데이터를 이루고 있는 공간이나 그 가까운 공간에 접근하는 특성

- - -
### 2. 캐시히트와 캐시미스
- 캐시히트: 캐시에서 원하는 데이터를 찾은 것
- 캐시미스: 해당 데이터가 캐시에 없다면 주 메모리로 가서 데이터를 찾아오는 것

![캐시히트와 캐시미스](https://user-images.githubusercontent.com/54324782/190951062-eff67569-bff0-4520-89d8-32b85248cd4a.png)

- 캐시히트를 하게 되면 해당 데이터를 `제어장치`를 거쳐 가져오게 된다.
  - 캐시히트의 경우 위치도 가깝고 `CPU 내부 버스`를 기반으로 작동하기 때문에 빠르다.
- 캐시미스가 발생되면 `메모리`에서 가져오게 된다.
  - `시스템 버스`를 기반으로 작동하기 때문에 느리다.

#### 💡 캐시매핑
: 캐시가 히트되기 위해 매핑하는 방법
- CPU의 레지스터와 주 메모리(RAM) 간에 데이터를 주고받을 때를 기반으로 설명

#### "캐시매핑 분류"
| 이름 | 설명 |
|:--------:|:--------:|
| 직접 매핑 <br>(directed mapping) | 메모리가 1-100이 있고 캐시가 1-10이 있다면 1:1-10, 2:1-20··· 이런 식으로 매핑하는 것을 말한다. <br>처리가 빠르지만 충돌 발생이 잦다. |
| 연관 매핑 <br>(associative mapping) | 순서를 일치시키지 않고 관련 있는 캐시와 메모리를 매핑한다. <br>충돌이 적지만 모든 블록을 탐색해야 해서 속도가 느리다. |
| 집합 연관 매핑 <br>(set associative mapping) | 직접 매핑과 연관 매핑을 합쳐 놓은 것. <br>순서는 일치시키지만 집합을 둬서 저장하며 블록화되어 있기 때문에 검색은 좀 더 효율적이다. <br>예를 들어 메모리가 1-100이 있고 캐시가 1-10이 있다면 캐시 1-5에는 1-50의 데이터를 무작위로 저장시키는 것 |

#### 💡 웹 브라우저의 캐시
#### 1. 쿠키
- 만료기한이 있는 키-값 저장소
- same site 옵션을 strict로 설정하지 않았을 경우 다른 도메인에서 요청했을 때 자동 전송된다.
- 4KB까지 데이터를 저장할 수 있고 만료기한을 정할 수 있다.
- 쿠키를 설정할 때는 document.cookie로 쿠키를 볼 수 없게 httponly 옵션을 거는 것이 중요하다.
- 클라이언트 또는 서버에서 만료기한 등을 정할 수 있는데 보통 서버에서 만료기한을 정한다.

#### 2. 로컬 스토리지
- 만료기한이 없는 키-값 저장소
- 10MB까지 저장할 수 있으며 웹 브라우저를 닫아도 유지되고 도메인 단위로 저장, 생성된다.
- HTML5를 지원하지 않는 웹 브라우저에서는 사용할 수 없으며 클라이언트에서만 수정 가능하다.

#### 3. 세션 스토리지
- 만료기한이 없는 키-값 저장소
- 탭 단위로 세션 스토리지를 생성하며, 탭을 닫을 때 해당 데이터가 삭제된다.
- 5MB까지 저장이 가능하며 HTML5를 지원하지 않는 웹 브라우저에서는 사용할 수 없다.
- 클라이언트에서만 수정 가능하다.

#### "추가"
- 데이터베이스 시스템을 구축할 때도 메인 데이터베이스 위에 `레디스(redis)` 데이터 베이스 계층을 `캐싱 계층`으로 둬서 성능을 향상시키기도 한다.

